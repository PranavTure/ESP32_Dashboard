<!DOCTYPE html>
<html>
<head>
  <title>ESP32 Control</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

<body style="text-align:center; font-family:Arial;">
  <h1>ESP32 LED Control</h1>

  <button id="btn"
    style="width:150px;height:60px;font-size:20px;background:red;color:white;">
    OFF
  </button>

<script>
  const btn = document.getElementById("btn");

  const client = mqtt.connect(
    "wss://broker.hivemq.com:8000/mqtt",
    {
      clientId: "WebClient_" + Math.floor(Math.random() * 10000),
      username: "pranav_user",
      password: "mypassword123"
    }
  );

  client.on("connect", () => {
    console.log("Connected to MQTT");
    client.subscribe("pranav/esp32/led");
  });

  client.on("message", (topic, message) => {
    const msg = message.toString();

    if (msg === "ON") {
      btn.innerText = "ON";
      btn.style.background = "green";
    } else if (msg === "OFF") {
      btn.innerText = "OFF";
      btn.style.background = "red";
    }
  });

  btn.onclick = () => {
    if (btn.innerText === "OFF") {
      client.publish("pranav/esp32/led", "ON");
    } else {
      client.publish("pranav/esp32/led", "OFF");
    }
  };
</script>
</body>
</html>
