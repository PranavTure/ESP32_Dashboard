<!DOCTYPE html>
<html>
<head>
  <title>ESP32 LED Control</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

<body style="text-align:center;font-family:Arial;">
  <h1>ESP32 LED Control</h1>

  <button id="btn"
    style="width:150px;height:60px;font-size:20px;background:gray;color:white;">
  </button>

<script>
  const btn = document.getElementById("btn");

  const client = mqtt.connect("wss://broker.hivemq.com:8004/mqtt", {
    clientId: "WebClient_" + Math.floor(Math.random() * 10000)
  });

  client.on("connect", () => {
    console.log("Connected");
    client.subscribe("pranav/esp32/led/state");
  });

  // ESP32 FEEDBACK (ONLY THIS changes button color)
  client.on("message", (topic, message) => {
    const msg = message.toString();

    if (msg === "ON") {
      btn.innerText = "ON";
      btn.style.background = "green";
    } else {
      btn.innerText = "OFF";
      btn.style.background = "red";
    }
  });

  // Send COMMAND only
  btn.onclick = () => {
    if (btn.innerText === "ON") {
      client.publish("pranav/esp32/led/cmd", "OFF");
    } else {
      client.publish("pranav/esp32/led/cmd", "ON");
    }
  };
</script>
</body>
</html>


